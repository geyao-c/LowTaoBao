<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6 lt8"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7 lt8"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8 lt8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
	<meta charset="UTF-8" />
	<title>servlet处理数据</title>
	<!-- 包含头部信息用于适应不同设备 -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- 包含 bootstrap 样式表 -->
	<link rel="stylesheet" href="https://apps.bdimg.com/libs/bootstrap/3.2.0/css/bootstrap.min.css">
</head>

<body>
	<br>

	<div class="container">
		<br><br>
		<center>
			<div class="col-sm-offset-1 col-sm-10">
				<a class="btn btn-info btn-lg" href="index.html">回到主页</a>&nbsp&nbsp&nbsp&nbsp
				<button class="btn btn-info btn-lg" onclick="add_car()">点击添加到购物车</button>&nbsp&nbsp&nbsp&nbsp
				<a class="btn btn-info btn-lg" href="car.html">查看购物车</a>&nbsp&nbsp&nbsp&nbsp
			</div>
		</center>
		<br><br><br>

		<br />
		<br />

		<!--  获取商品列表  -->
		<table class="table table-striped">
			<thead>
				<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
				<script>
					// 设置项目的基础 url
					var baseUrl = "http://localhost:8080/_war_exploded";
					console.log("执行查询js");
					window.onload = init;
					function init() {
						init_table();
					}
					function init_table() {
						$.ajax({
							url: baseUrl + "/items",
							data: {
								table_name: "person"
							},
							type: "POST",
							dataType: "json",
							success: function (data) {
								console.log("查询person成功");
								console.log(data);
								console.log(data.data);
								console.log(data.person);
								var tb = document.getElementById("table2");
								for (var i = 0; i < data.items.length; ++i) {
									console.log("i = " + i);
									var str = "";
									str += "<tr>\n";
									str +=
										"    <td><input type=\"checkbox\" name=\"checkItem\" " +
											"value=\"" + data.items[i].GoodId + "\" />" + data.items[i].GoodId + "</td>\n" +
											"    <td>" + data.items[i].GoodName + "</td>\n" +
											"    <td>" + data.items[i].Price + "</td>\n" +
											"    <td>" + data.items[i].Number + "</td>\n" +
											"    <td>" + data.items[i].Category + "</td>\n";
									str += "</tr>";
									tb.innerHTML += str;
									console.log(str);
								}
							}
						})
					}
				</script>
			</thead>
		</table>

		<div class="jumbotron">
			<center>
				<h2>商品列表</h2>
			</center>
		</div>

		<table class="table table-striped">
			<thead>
				<tr>
					<td scope="col">GoodId</td>
					<td scope="col">GoodName</td>
					<td scope="col">Price</td>
					<td scope="col">Number</td>
					<td scope="col">Category</td>
				</tr>
			</thead>
			<tbody id="table2">
			</tbody>

			<br><br><br><br>

	</div>


<!--  提交到购物车  -->
	<script>
		var baseUrl = "http://localhost:8080/_war_exploded";
		function add_car() {
			var items = document.getElementsByName("checkItem");
			var list_str = "";
			for (var i = 0; i < items.length; i++) {
				// 检查复选框状态
				if (items[i].checked) {
					list_str += items[i].value + ",";
				}
			}
			$.ajax({
				url: baseUrl + "/add_car",
				data: {
					items: list_str
				},
				traditional: true,
				type: "POST",
				dataType: "json",
				success: function (data) {
					console.log(data);
					if (data.error == "1") {
						alert("添加成功");
					} else {
						alert("添加失败, 请确认勾选商品或商品有库存");
					}
				},
				error: function (data) {
					alert("添加失败");
				}
			})
		}
	</script>


	<p id="demo"></p>
	<script>
		if (screen && screen.width > 480) {
			document.write('<script type="text/javascript" color="102,185,255" opacity="100" zIndex="-2" count="299" src="//static.ffis.me/javascript/canvas-nest.min.js"><\/script>');
		}
	</script>
	<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript">
		/* 鼠标点击特效 - 7Core.CN */
		var a_idx = 0; jQuery(document).ready(function ($) {
			$("body").click(function (e) {
				var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正", "法治", "爱国", "敬业", "诚信", "友善"); var $i = $("<span/>").text(a[a_idx]);
				a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ "z-index": 100000000, "top": y - 20, "left": x, "position": "absolute", "font-weight": "bold", "color": "#ff6651" }); $("body").append($i); $i.animate({ "top": y - 180, "opacity": 0 }, 1500, function () { $i.remove(); });
			});
		});
	</script>

</body>

</html>